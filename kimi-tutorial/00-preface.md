# 第 0 章：前言

## 为什么要构建 Coding Agent？

在 2023 年，随着 ChatGPT、Claude 等大语言模型的崛起，AI 已经展现出令人惊叹的代码理解和生成能力。但是，仅仅能够"对话"是不够的——我们需要能够**行动**的 AI。

### Coding Agent 是什么？

Coding Agent 是一种能够：
- 📖 **理解**你的需求和代码库
- 🔧 **使用工具**读写文件、执行命令
- 🤔 **推理**复杂问题的解决方案
- 🔄 **迭代**直到任务完成
- 🤝 **协作**与你和其他 Agent 一起工作

简而言之，Coding Agent = **LLM（大脑）+ Tools（手）+ Context（记忆）**

### 为什么选择 Kimi-CLI？

Kimi-CLI 是一个优秀的 Coding Agent 实现，它具有：

1. **清晰的架构**：分层设计，职责明确
2. **强大的功能**：文件操作、Shell 执行、多代理协作
3. **实用的特性**：时间旅行、思维链、审批系统
4. **良好的工程实践**：异步设计、依赖注入、协议抽象
5. **真实的生产案例**：已被广泛使用和测试

通过学习 kimi-cli 的设计，你将掌握构建 AI Agent 的核心技能。

## 你将学到什么？

### 🏗️ 架构设计

- **模块化**：如何将 Agent 拆分成可组合的模块
- **抽象层次**：Soul（执行引擎）、Tools（能力）、KAOS（OS 抽象）
- **扩展性**：如何设计易于扩展的插件系统

### 🔌 LLM 集成

- **统一接口**：支持多种 LLM（OpenAI、Anthropic、Moonshot）
- **流式处理**：实时显示生成内容
- **工具调用**：Function Calling 的实现原理
- **Token 管理**：上下文窗口和成本控制

### 🛠️ 工具系统

- **工具协议**：如何定义统一的工具接口
- **动态加载**：从配置文件加载工具
- **依赖注入**：工具如何获取系统依赖
- **错误处理**：优雅地处理工具执行失败

### 💾 状态管理

- **对话历史**：如何存储和加载消息
- **检查点**：实现"时间旅行"功能
- **会话持久化**：跨会话保持上下文

### 🎨 用户体验

- **多种 UI 模式**：命令行、脚本、IDE 集成
- **交互设计**：审批流程、进度显示
- **错误提示**：友好的错误信息

## 本书的学习路径

```
                    ┌─────────────────┐
                    │   基础概念      │
                    │  (第 1-2 章)    │
                    └────────┬────────┘
                             │
                    ┌────────▼────────┐
                    │  最小可用 Agent  │
                    │   (第 3 章)     │
                    └────────┬────────┘
                             │
         ┌───────────────────┼───────────────────┐
         │                   │                   │
    ┌────▼─────┐       ┌────▼─────┐       ┌────▼─────┐
    │  工具系统 │       │ 上下文    │       │  审批    │
    │ (第 4 章) │       │(第 5 章)  │       │(第 8 章) │
    └────┬─────┘       └────┬─────┘       └────┬─────┘
         │                   │                   │
         └───────────────────┼───────────────────┘
                             │
                    ┌────────▼────────┐
                    │   完整的 Agent   │
                    │  (第 6-9 章)    │
                    └────────┬────────┘
                             │
                    ┌────────▼────────┐
                    │   高级特性       │
                    │ (第 10-13 章)   │
                    └────────┬────────┘
                             │
                    ┌────────▼────────┐
                    │  工程化部署      │
                    │ (第 14-20 章)   │
                    └─────────────────┘
```

## 前置知识

要充分理解本书内容，你应该具备：

- ✅ **Python 基础**：熟悉 Python 3.10+ 语法
- ✅ **异步编程**：了解 `async`/`await`
- ✅ **命令行**：能够使用终端和 Shell
- ✅ **Git 基础**：基本的版本控制知识
- ⭐ **LLM 概念**：了解 ChatGPT、Claude 等（加分项）
- ⭐ **类型提示**：了解 Python Type Hints（加分项）

如果你对某些概念不熟悉，不用担心——我们会在需要时进行讲解。

## 实践建议

### 💡 学习方法

1. **理解原理**：先理解为什么要这样设计，再看怎么实现
2. **动手编码**：每章都有代码示例，请亲自实现
3. **对比源码**：将你的实现与 kimi-cli 源码对比
4. **实验探索**：尝试修改代码，观察结果
5. **记录笔记**：记录你的思考和疑问

### 🔧 开发环境

建议准备以下工具：

- Python 3.10 或更高版本
- 一个代码编辑器（VS Code、PyCharm 等）
- Git 版本控制
- 一个 LLM API Key（Moonshot、OpenAI 或 Anthropic）

### 📖 阅读建议

- **第一遍**：快速浏览，了解整体架构
- **第二遍**：仔细阅读，动手实践代码
- **第三遍**：深入细节，理解设计决策

## 本书约定

### 代码块

```python
# Python 代码示例
def hello_agent():
    """这是一个示例函数"""
    print("Hello, Agent!")
```

```bash
# Shell 命令
$ python -m pip install kimi-cli
```

```yaml
# 配置文件
agent:
  name: my-agent
  tools: []
```

### 提示框

> 💡 **提示**：这里是一些有用的提示和技巧

> ⚠️ **注意**：需要特别注意的地方

> 🔍 **深入**：更深入的技术细节

> 🎯 **实践**：动手练习的建议

### 参考链接

[kimi-cli 源码](https://github.com/你的仓库/kimi-cli) - 随时参考

## 开始之前

在开始阅读之前，建议你先：

1. ⭐ **Star** kimi-cli 仓库
2. 📥 **Clone** 代码到本地
3. 🏃 **运行** 一次 kimi-cli，感受它的能力
4. 📖 **阅读** kimi-cli 的 README

准备好了吗？让我们开始这段激动人心的旅程！

---

**下一章**：[第 1 章：核心概念](./01-core-concepts.md) →
